               ; SCREENSHOT64 BY LUTZ BELLMANN               ; --------------------------------------               ; --------------------------------------               ; PRESS F7 FOR MAKING THE SCREENSHOT               ; --------------------------------------               ; KERNAL ROUTINES               ; ------------------               IOINIT   = $FF84               CINT     = $FF81               SETNAM   = $FFBD               SETLFS   = $FFBA               SETMSG   = $FF90               SAVE     = $FFD8               OPEN     = $FFC0               GETIN    = $FFE4               CHROUT   = $FFD2               CHRIN    = $FFCF               ; POINTERS               ; ------------------               POINT1   = $FB               POINT2   = $FD               ; DATA               ;-------------------               FNAME    = $02A7               BUFFER   = $02F0               FNAMELEN = $02F1               FINDEX   = $02F2               HIGHMEM  = $C000               EXTCOL   = $D020                        *= $08010801 0D 08 E2 07                        .WORD SETUP-2,20180805 9E                 .BYTE $9E0806 20 32 30 36 33 3A                        .TEXT " 2063:"080C 00 00 00           .BYTE $00,$00,$00080F 20 81 FF  SETUP    JSR CINT0812 A2 81              LDX #MCODELEN0814 BD EF 08  LOOP0    LDA MCODE0,X ; MOVE INTERRUPT0817 9D EF 08           STA MCODE,X  ; TO HIMEM081A CA                 DEX081B 10 F7              BPL LOOP0081D A2 00              LDX #$00081F BD 7E 08  LOOP3    LDA INFOMSG,X ; PRINT INFO0822 20 D2 FF           JSR CHROUT    ; MESSAGE0825 E8                 INX0826 E0 71              CPX #INFOMSGLEN0828 D0 F5              BNE LOOP3082A A2 00              LDX #$00082C BD 6E 08  LOOP1    LDA GETFILE,X ; PRINT WELCOME082F 20 D2 FF           JSR CHROUT    ; MESSAGE0832 E8                 INX0833 E0 10              CPX #GETFILELEN0835 D0 F5              BNE LOOP10837 A9 00              LDA #$000839 A0 00              LDY #$00083B 20 CF FF  LOOP2    JSR CHRIN    ; GET FILENAME083E 99 A7 02           STA FNAME,Y  ; FROM USER0841 C8                 INY0842 C9 0D              CMP #130844 D0 F5              BNE LOOP20846 88                 DEY      ; CLEAR CARRIAGE RET0847 C0 09              CPY #9    ; TRUNCATE FILELEN0849 90 02              BCC NOT0   ; GREATER THAN 9084B A0 09              LDY #9084D A9 2D     NOT0     LDA #"-"    ; APPEND INDEX084F 99 A7 02           STA FNAME,Y0852 C8                 INY0853 A9 30              LDA #"0"0855 99 A7 02           STA FNAME,Y0858 C8                 INY0859 8C F1 02           STY FNAMELEN; SAVE FNAME LEN085C A9 30              LDA #"0"  ; SET FILEINDEX085E 8D F2 02           STA FINDEX   ; TO 00861 78                 SEI        ; DISABLE INTERRUPTS0862 A9 50              LDA #<ISR  ; CHG INTERRUPT0864 8D 14 03           STA $03140867 A9 09              LDA #>ISR0869 8D 15 03           STA $0315086C 58                 CLI        ; ENABLE INTERRUPTS086D 60                 RTS               ; TEXT PASSAGE               ; -----------------               GETFILE  = *086E 45 4E 54 45 52 20 46 49 4C 45 4E 41 4D 45 3A 20                        .TEXT "ENTER FILENAME: "               GETFILELEN = *-GETFILE               ; ---------               INFOMSG  = *087E 53 43 52 45 45 4E 53 48 4F 54 36 34 20 56 31 2E 31 20 42 59                        .TEXT "SCREENSHOT64 V1.1 BY"0892 20 4C 55 54 5A 20 42 45 4C 4C 4D 41 4E 4E                        .TEXT " LUTZ BELLMANN"08A0 0D                 .BYTE 1308A1 2D 46 37 20 2D 3E 20 53 41 56 45 20 53 43 52 45 45 4E 20 26                        .TEXT "-F7 -> SAVE SCREEN &"08B5 20 45 58 49 54                        .TEXT " EXIT"08BA 0D                 .BYTE 1308BB 2D 46 35 20 2D 3E 20 53 41 56 45 20 53 43 52 45 45 4E 20 26                        .TEXT "-F5 -> SAVE SCREEN &"08CF 20 43 4F 4E 54 49 4E 55 45                        .TEXT " CONTINUE"08D8 0D                 .BYTE 1308D9 2D 52 2F 53 2C 52 45 53 54 4F 52 45 20 2D 3E 20 42 52 45 41 4B                        .TEXT "-R/S,RESTORE -> BREAK"08EE 0D                 .BYTE 13               INFOMSGLEN = *-INFOMSG               ; SAVE $400-$7E8 TO DISK               ;-----------------------               MCODE0   = *               MCODE    .OFFS $C000-MCODE008EF A9 31     SAVESCR  LDA #<$EA31 ; STD VEKTOR08F1 8D 14 03           STA $031408F4 A9 EA              LDA #>$EA31 ; WIEDERHERSTELLEN08F6 8D 15 03           STA $031508F9 AD 6F 09  SAVECNT  LDA BUSY   ; TASTE GERADE ERST08FC C9 01              CMP #$0108FE F0 47              BEQ BREAK   ; GEDRUECKT? ABBR.0900 A9 01              LDA #$010902 8D 6F 09           STA BUSY   ; BUSY FLAG SETZEN0905 8D 20 D0           STA EXTCOL ; WEISSER RAND0908 AC F1 02           LDY FNAMELEN; FILE INDEX090B 88                 DEY090C EE F2 02           INC FINDEX   ; ERHOEHEN090F AD F2 02           LDA FINDEX0912 99 A7 02           STA FNAME,Y  ; IN DATEINAMEN0915 A9 00              LDA #$000917 20 90 FF           JSR SETMSG ; NO KERNAL MESS091A A9 78              LDA #120091C 85 CD              STA $CD    ; DELAY CURSOR091E AD F1 02           LDA FNAMELEN0921 A2 A7              LDX #<FNAME  ; POINTER TO0923 A0 02              LDY #>FNAME  ; FILENAME0925 20 BD FF           JSR SETNAM   ; SET FILENAME0928 A9 01              LDA #$01092A A6 BA              LDX $BA    ; CURR. DEV. NO092C A0 FF              LDY #$FF092E 20 BA FF           JSR SETLFS   ; SET д# AND FILE0931 A9 00              LDA #$000933 85 FB              STA POINT10935 A9 04              LDA #$040937 85 FC              STA POINT1+1 ;POINTER TO VICSCR0939 A9 FB              LDA #POINT1093B A2 E8              LDX #$E8093D A0 07              LDY #$07093F 20 D8 FF           JSR SAVE   ; SAVE TO DISK0942 A9 0E              LDA #140944 8D 20 D0           STA EXTCOL ; RESTORE COLOR0947 AD 0D DC  BREAK    LDA $DC0D     ; INTERRUPT BEST.094A 68                 PLA   ; ALLES VOM094B A8                 TAY          ; STAPEL HOLEN094C 68                 PLA094D AA                 TAX094E 68                 PLA094F 40                 RTI   ; RETURN FROM IRQ               ; MODIFIED IRQ ROUTINE               ; ----------------------0950 A5 CB     ISR      LDA $CB     ; READ KEY MATRIX0952 C9 03              CMP #$03    ; F7 PRESSED?0954 D0 03              BNE NOT10956 4C EF 08           JMP SAVESCR0959 C9 06     NOT1     CMP #$06    ; F5 PRESSED095B D0 0A              BNE NOT2095D AD 6F 09           LDA BUSY0960 C9 01              CMP #$010962 F0 08              BEQ NOT30964 4C F9 08           JMP SAVECNT0967 A9 00     NOT2     LDA #$00   ; CLEAR0969 8D 6F 09           STA BUSY   ; BUSY FLAG096C 4C 31 EA  NOT3     JMP $EA31    ; JMP STANDARD иря               BUSY     = *096F 00                 .BYTE $00               MCODELEN = *-MCODE